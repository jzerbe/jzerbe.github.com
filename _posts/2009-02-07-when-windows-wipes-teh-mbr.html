--- 
layout: post
title: when windows wipes teh MBR
tags: 
- grub
- Linux
- Windows
status: publish
type: post
published: true
meta: 
  _edit_last: "1"
---
I installed Windows XP Home on some leftover space on one of my CentOS OpenVZ machines that I use for development purposes. It is nice to have a ready to go system for when friends come over and we get to hankering for some LAN gaming. So install my Windows to the leftover space and of course it wipes the Master Boot Record. Bah! So I get out my CentOS install disk and type in "<code>linux rescue</code>" at the install prompt. From there I was kind of lost, so I searched around and found a <a href="http://gnuslashlinux.blogspot.com/2004/07/how-to-restore-grub.html">short guide to restoring the GRUB boot loader</a>. After that everything was smiles.

My process:
<ol>
	<li>Get a linux install disk and type "<code>linux rescue</code>" at the install prompt</li>
	<li>The rescue process should mount any of the found linux systems. (It did in my case.) The rescue process mounted my linux installation to "<code>/mnt/sysimage</code>". I then chrooted into my system: "<code>chroot /mnt/sysimag</code>".</li>
	<li>My main hard drive in said machine is named "hda", so I reinstalled GRUB to /dev/hda with the command: "<code>grub-install /dev/hda</code>". My original GRUB configuration was restored successfully.</li>
	<li>I then added the boot entry for the new Windows XP Home installation. I had installed it to the 3rd partition on the main hard drive so I added the following entry to my GRUB menu.lst file (/boot/grub/menu.lst).
<blockquote><code>title Windows XP Home
root (hd0,2)
savedefault
makeactive
chainloader +1</code></blockquote>
(hd0,2) = (the first hard drive, 3rd partition). Thus, (hd0,0) would be the first hard drive and first partition.</li>
	<li>Just remember to exit the chroot'ed shell before you reboot. Otherwise everything we just did goes to pot.</li>
</ol>
And everything was working spiffy after that.

