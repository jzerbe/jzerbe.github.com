---
layout: post
title: error reading certificate file amitools/cert-ec2.pem
tags:
- AWS
- AMI
- certificate
- bundle
status: publish
type: post
published: true
meta:
_edit_last: "1"
---
I was working through creating a bunch of
<abbr title="Amazon Machine Instance">AMI</abbr>s for internal work use.
And here is the kicker: they all descend from a single Debian 6 image with
some custom Java and build tools support.<br />
<br />
I proceeded to get the "error reading certificate file amitools/cert-ec2.pem"
error, as
<a href="https://forums.aws.amazon.com/thread.jspa?threadID=84085">posted by traxonius</a>,
when trying to create new descendant images.<br />
I also had the pleasure of getting keyring errors because all of the
Debian apt-get keyring files get dumped by the AMI bundle rules.<br />
<br />
<strong>my original API/AMI setup</strong><br />
I set up my tools in /opt/ec2 based on the following commands from the
<a href="http://wiki.debian.org/Cloud/CreateEC2Image"><i>CreateEC2Image</i> article on the Debian project wiki</a>.
<blockquote>
    <code>
        wget http://s3.amazonaws.com/ec2-downloads/ec2-api-tools.zip<br />
        wget http://s3.amazonaws.com/ec2-downloads/ec2-ami-tools.zip<br />
        unzip ec2-api-tools.zip<br />
        unzip ec2-ami-tools.zip<br />
        mkdir ec2<br />
        rsync -ar ec2-api-tools-*/* ec2<br />
        rsync -ar ec2-ami-tools-*/* ec2<br />
        rm -rf ec2-api-tools*<br />
        rm -rf ec2-ami-tools*<br />
    </code>
</blockquote>
<br />
<strong>the hackish fix</strong><br />
If you are only using these images for intra-company use, then you might be able
to take advantage of the slightly hackish solution I used. You probably need to
adjust the base directory to where you have your AMI tools installed. I removed
the excerpted lines from the following file, not including the lines
covered by the ellipsis.<br />
<code>/opt/ec2/lib/ec2/platform/base/constants.rb</code><br />
<blockquote>
    <code>
        '"*.pem"',<br />
        '"*.priv"',<br />
        ...<br />
        '"*.gpg"',<br />
    </code>
</blockquote>
<br />
